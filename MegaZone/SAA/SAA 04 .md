# SAA-C02 4회차

25. AutoScaling 종료 정책

 1. 인스턴스가 가장 많으며 축소로부터 보호되지 않는 인스턴스가 최소 하나 이상 있는 가용 영역을 확인합니다.

 2. 종료할 인스턴스를 결정하고 종료 중인 온디맨드 또는 스팟 인스턴스의 할당 전략에 나머지 인스턴스를 맞춥니다. 이는 할당 전략을 지정하는 Auto Scaling 그룹에만 적용됩니다.

 예를 들어 인스턴스가 시작된 후 기본 설정 인스턴스 유형의 우선 순위를 변경할 경우, 축소 이벤트가 발생했을 때 Amazon EC2 Auto Scaling이 온디맨드 인스턴스를 우선 순위가 낮은 인스턴스 유형에서 점진적으로 이동하려고 시도합니다.

 3. 이 중에서 가장 오래된 시작 템플릿 또는 구성을 사용하는 인스턴스가 있는지 확인합니다.

  3.1 [시작 템플릿을 사용하는 Auto Scaling 그룹의 경우] 

  시작 구성을 사용하는 인스턴스가 없는 한 가장 오래된 시작 템플릿을 사용하는 인스턴스가 있는지 확인합니다. Amazon EC2 Auto Scaling은 시작 템플릿을 사용하는 인스턴스 이전에 시작 구성을 사용하는 인스턴스를 종료합니다.

  3.2. [시작 구성을 사용하는 Auto Scaling 그룹의 경우]

  이 중에서 가장 오래된 시작 구성을 사용하는 인스턴스가 있는지 확인합니다.

 4. 위의 기준에 따라 종료할 비보호 인스턴스가 여러 개 있는 경우, 다음 결제 시간에 가장 근접한 인스턴스가 무엇인지 확인합니다. 다음 번 결제 시간에 가장 근접한 비보호 인스턴스가 여러 개인 경우 이러한 인스턴스 중 하나를 임의로 종료합니다.

다음 결제 시간에 가장 근접한 인스턴스를 종료하면 시간당 청구되는 인스턴스의 사용을 극대화할 수 있습니다. 또는 해당 Auto Scaling 그룹에서 Amazon Linux 또는 Ubuntu를 사용하는 경우 EC2 사용량은 초 단위로 요금이 부과됩니다.

26. S3
- S3 업로드 데이터 옵션
 - 가용성이 높으며 무제한으로 확장 가능
 - 단일 작업으로 객체 업로드 : 단일 PUT 작업으로 최대 5GB 크기의 객체 업로드
 - 파트로 나누어 객체 업로드 : 멀티파트 업로드 API를 사용하여 최대 5TB의 대형 객체 업로드

27. SQS
Amazon Simple Queue Service (SQS)는 마이크로 서비스, 분산 시스템 및 서버리스 애플리케이션을 분리하고 확장할 수 있는 완전 관리형 메시지 대기열 서비스입니다.

처리가 완료되면 대기열에서 메시지를 처리하고 삭제하는 것은 소비자 애플리케이션의 책임입니다. 그렇지 않으면 소비자 응용 프로그램에서 메시지를 반복적으로 처리합니다. SQS 대기열은 기본 보존 기간이 4일이며 메시지 보존 할당량에 도달하면 메시지가 자동으로 삭제됩니다. 이는 메시지를 처리하는 동안 첫 번째 소비자 응용 프로그램이 실패하는 경우 다른 소비자가 메시지를 계속 처리할 수 ​​있도록 하기 위한 것입니다.

처리 후 메시지를 삭제하지 않도록 소비자 응용 프로그램이 잘못 구성된 경우 사용 사례에 설명된 대로 이 문제를 볼 수 있습니다.

Amazon SQS는 대기열에서 메시지를 수신하기 위해 짧은 폴링 및 긴 폴링을 제공합니다. 기본적으로 대기열은 짧은 폴링을 사용합니다.

짧은 폴링을 사용하여 ReceiveMessage 요청은 서버의 하위 집합(가중치 임의 분포를 기반으로 함)만 쿼리하여 응답에 포함할 수 있는 메시지를 찾습니다. Amazon SQS는 쿼리에서 메시지를 찾지 못하더라도 응답을 즉시 전송합니다.

긴 폴링을 사용하면 ReceiveMessage 요청이 모든 서버에서 메시지를 쿼리합니다. Amazon SQS는 적어도 하나의 사용 가능한 메시지를 수집한 후 요청에 지정된 최대 메시지 수까지 응답을 보냅니다. Amazon SQS는 폴링 대기 시간이 만료되는 경우에만 빈 응답을 보냅니다.

27. 

