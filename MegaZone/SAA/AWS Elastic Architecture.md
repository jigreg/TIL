# AWS SAA

---

## 탄력적 아키텍처 설계

### AWS Route 53

- 지연시간 기반 라우팅을 통해 사용자를 지연 시간이 가장 짧은 AWS 엔드포인트로 보냄
- Route 53 DNS 서버는 지난 몇 주간의 네트워크 조건에 따라 특정 사용자에게 제공할 리전 및 해당 리전의 인스턴스 결정
- A,AAAA,TXT 및 CNAME 레코드에 대한 지연 시간 기반 라우팅, 별칭 지원
- 로드 밸런서는 트래픽을 다른 AWS 리전으로 분신하지 않고 해당 리전 내에서만 분산
- Route 53을 사용하여 두 개 이상의 AWS 리전으로 들어오는 로드를 밸런싱

---

#### 장애 조치

- 액티브-액티브 장애 조치 : 모든 리소스를 대부분의 시간 동안 사용 가능하도록
  동일한 이름, 동일한 유형(A 또는 AAAA) 및 동일한 라우팅 정책(가중치, 지연시간)를 보유한 모든 레코드는 Route 53이 비정상으로 간주하지 않는 이상 활성 상태
  Route 53은 정상 레코드를 사용하여 DNS 쿼리 응답
- 액티브-패시브 장애 조치 : 기본 리소스 또는 리소스 그룹이 대부분의 시간동안 사용가능하도록 하고 보조 리소스 또는 리소스 그룹은 기본 리소스가 사용 불가능할 경우를 대비 해 대기중에 있도록
  쿼리에 응답할 때 Route 53은 정상적인 1차 리소스 포함
  1차 리소스가 비정상이면 정상적인 2차 리소스만 포함

#### 쿼리 응답 방식

- 단순 라우팅 정책 : 도메인에 대해 특정 기능을 수행하는 하나의 리소스만 있을때
- 장애 조치 라우팅 정책 : 액티브-패시브 장애 조치 구성
- 지리 위치 라우팅 정책 : 사용자의 위치에 기반하여 트래픽 라우팅하는 경우
- 지리 근접 라우팅 정책 : 리소스의 위치를 기반으로 트래픽을 라우팅하고 필요에 따라 한 위치의 리소스에서 다른 위치의 리소스로 트래픽을 보내려는 경우
- 지연 시간 라우팅 정책 : 여러 AWS 리전에 리소스가 있고 최상의 지연 시간을 제공하는 리전으로 트래픽을 라우팅하려는 경우
- 다중 응답 라우팅 정책 : Route 53이 DNS 쿼리에 무작위로 선택된 초대 8개의 정상 레코드로 응답하게 하려는 경우
- 가중치 기반 라우팅 정책 : 사용자가 지정하는 비율에 따라 여러 리소스로 트래픽을 라우팅하려는 경우

### AWS RDS

- RDS 인스턴스는 데이터베이스일 뿐 정적 콘텐츠를 저장하기에 적합 X
- RDS는 다중 AZ 배포 구성에서 실행되지 않는 한 내구성 X
- 다중 AZ 배포는 RDS 데이터베이스 인스턴스를 위해 향상된 가용성 및 내구성을 제공 -> 프로덕션 데이터베이스 워크로드에 적합
- 다중 AZ DB 인스턴스를 프로비저닝하면 Amazon RDS는 자동으로 하나의 기본 DB 인스턴스를 생성하고 동시에 다른 가용 영역의 예비 인스턴스에 데이터 복제
- 각 AZ는 물리적으로 분리된 자체 독립 인프라에서 실행되며 높은 안정성 제공
- 인프라 장애가 발생해도 예비 인스턴스로 자동 장애 조치를 수행
- 장애 조치 후에도 DB 인스턴스의 엔드 포인트는 그대로 유지
- RDS 엔진 사용하면 확장성을 높이기 위해 읽기 전용 복제본 추가하고 장애 발생 시 데이터베이스 가용성을 유지
- 읽기 전용 복제본은 다른 AZ에서 자체 예비 인스턴스와 함께 설정
- 다중 AZ는 RDS에 대한 동기 복제 (Aurora: 비동기식 복제)
- 장애 조치는 RDS가 자동으로 처리하므로 관리자가 개입하지 않고 신속하게 데이터베이스 작업을 재개
- 장애 조치 시, RDS는 DB 인스턴스의 정식 이름 레코드(CNAME)가 예비 복제본을 가리키도록 변경
- 예비 복제본이 승격되어 새 기본 복제본이 됨

### Amazon EBS 볼륨

- S3에 비해 내구성이 떨어짐
- 내구성이 있는 블록 수준 스토리지 디바이스, 인스턴스 연결 가능
- 물리적 하드드라이브처럼 사용, 유연함
- 현재 세대 볼륨은 크기를 동적으로 늘리고 프로비저닝된 IOPS 용량을 수정
- 여러 EBS 볼륨을 단일 인스턴스에 연결, 볼륨 및 인스턴스는 동일 가용 영역에 위치
- 볼륨 및 인스턴스 유형에 따라 다중 연결을 사용하여 볼륨을 여러 인스턴스에 동시에 탑재
- 자동으로 복제되고 단일 구성 요소에 장애가 발생해도 안전하게 보호
- 범용 SSD(gp2)
- 프로비저닝된 IOPS SSD(io1)
- 처리량에 최적화된 HDD(st1)
- Cold HDD(sc1)
- Magnetic(standard, 이전 세대 유형)

### AWS S3

- 인터넷상 어디서나 원하는 양의 데이터를 저장하고 검색할 수 있도록 구축된 객체 스토리지
- 안정성 뛰어나고 가용성이 높으며 무제한으로 확장 가능한 데이터 스토리지 인프라
- 정적 웹 사이트 호스팅 가능
- 동적 웹사이트 (PHP,JSP)등 서버 측 스크립트를 포함한 서버 측 처리에 의존
- 서버 측 암호화 지원 X

### AWS EC2 & VPC 서브넷

- EC2 인스턴스가 다시 시작되면 보유한 데이터가 즉시 지워짐
- 모든 서브넷은 해당 서브넷에서 생성된 네트워크 인터페이스에 퍼블릭 IPv4 주소가 할당 될 것인지 결정하는 수정 가능한 속성 가짐
- 기본이 아닌 서브넷은 IPv4 퍼블릭 주소 지정 속성이 false로 기본 설정되어 있고, 기본 서브넷은 이 속성이 true로 기본 설정

---

- 여러 Amazon EC2 인스턴스에서 하나의 웹 사이트를 호스팅하는 경우 Elastic Load Balancing 로드 밸런서를 사용하여 트래픽을 인스턴스 간에 분산
- 웹 사이트에 대한 트래픽이 시간에 따라 변화하면 자동 확장
- 로드 밸런서를 통해 등록된 인스턴스의 상태를 모니터링하고 상태가 양호한 인스턴스로만 도메인 트래픽을 라우팅
- 도메인 트래픽을 ELB 로드 밸런서로 라우팅하려면 Route 53을 사용하여 로드 밸런서를 지정하는 별칭 레코드 생성
- 별칭 레코드는 DNS에 대한 Route 53 확장
- Route 53 별칭 레코드는 Route 53 - DNS 기능에 고유 확장명 제공
- 별칭 레코드를 사용하면 CloudFront 배포와 S3 버킷 등 선택한 AWS 리소스로 트래픽 라우팅
- 호스팅 영역의 한 레코드에서 다른 레코드로 트래픽을 라우팅
-

### AWS IAM(Identity and Access Management)

- AWS 리소스에 대한 액세스를 안전하게 제어할 수 있는 웹 서비스
- IAM 그룹은 IAM 사용자들의 집합
- 그룹을 활용하면 다수의 사용자들에 대한 권한 지정, 권한 쉽게 관리
- 자격 증명 공급자를 사용하면 사용자 지정 로그인 코드를 생성할 필요도, 자신의 사용자 자격 증명을 관리할 필요도 없음
- Idp에서 이러한 작업을 대신 수행
- Amazon, Facebook, Google 에서도 Idp를 통해 로그인
- IAM 자격 증명 공급자는 애플리케이션으로 액세스 키 같은 장기 보안 자격 증명을 배포하거나 포함할 필요가 없으므로 AWS 계정 보안 ↑

### AWS 비용 할당 보고서

- 월별 cost allocation report에는 제품 카테코리 및 연결된 계정 사용자별 AWS 사용량이 나열
- detailed billing report와 동일한 행 항목 및 내 태그 키에 대한 추가 열 포함

### 네트워크 액세스 제어 목록

- 네트워크 액세스 제어 목록은 하나 이상의 서브넷으로 들어오고 나가는 트래픽을 제어하기 위한 방화벽 역할을 하는 VPC의 선택적 보안 계층
- 보안그룹은 인스턴스가 인바운드 및 아웃 바운드 트래픽을 제어하기 위한 방화벽 역할
- IAM 대시 보드에서 관리 X
- 보안그룹도 IAM 대시보드가 아닌 EC2 콘솔에서 관리

### Amazon Aurora

- 장애 조치는 Aurora에서 자동으로 처리하므로 수동 관리 작업 없이도 애플리케이션이 데이터베이스 작업을 빨리 재개
- 동일하거나 다른 가용 영역에 Aurora 복제본이 있는 경우 장애 조치시 Aurora는 DB 인스턴스의 표준 이름 레코드(CNAME)를 정상 복제본을 가리킴
- 장애 조치는 일반적으로 30초 내에 완료
- 복제본이 없고 Aurora 서버리스를 실행하지 않는 경우 Auora 서버리스를 실행하지 않는 경우 Aurora는 원래 인스턴스와 동일한 가용 영역에 새 DB 인스턴스를 생성 시도

### AWS Organizations

- AWS의 워크로드가 증가하고 확장됨에 따라 환경을 중앙에서 관리
- 계정 생성을 자동화하고, 비즈니스 요구를 반영하도록 계정 그룹을 생성하고, 거버넌스를 위해 이러한 그룹에 정책을 적용
- AWS 계정에 대해 단일 결제 방법을 설정하여 결제 과정 간소화
- 다른 AWS 서비스와 통합할 경우 Organization을 사용하여 조직의 계정 전반에 걸쳐 중앙 구성 및 리소스 공유를 정의
- 추가 비용 없이 사용
- 서비스 제어 정책(SCP)을 사용하여 AWS IAM 사용자 및 역할에 대한 권한 보호 계층을 적용

### AWS CloudFormation

- 클라우드 환경에서 AWS 및 타사 애플리케이션 리소스를 모델링하고 프로비저닝 할 수 있도록 공용 언어 제공
- 스택의 모든 논리적 리소스에 대해 Cloud Foramtion은 AWS 계정에 해당 물리적 리소스
- 논리적 리소스와 물리적 리소스를 동기화 상태로 유지

