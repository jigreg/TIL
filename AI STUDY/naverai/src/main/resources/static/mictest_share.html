<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>마이크 테스트</title>
</head>
<body>
   <button id="record">녹음</button>
    <button id="stop">정지</button>
    <div id="sound-clips"></div>
    <script>
        const record = document.getElementById("record")
        const stop = document.getElementById("stop")
        const soundClips = document.getElementById("sound-clips")

        if (navigator.mediaDevices) {
            console.log('getUserMedia supported.')
            const constraints = {
                audio: true
            }
       let chunks = []
       navigator.mediaDevices.getUserMedia(constraints)
           .then(function(stream) {
               const mediaRecorder = new MediaRecorder(stream)//녹음기
               record.onclick = function() {//녹음 버튼 클릭시에
                   mediaRecorder.start()// 음성 녹음 시작하라
                   console.log(mediaRecorder.state)
                   console.log("recorder started")
                   record.style.background = "red"
                   record.style.color = "black"
               }//record.onclick
               
               stop.onclick = function() {//정지 버튼 클릭시에
                   mediaRecorder.stop()//녹음 정지시켜라
                   console.log(mediaRecorder.state)
                   console.log("recorder stopped")
                   record.style.background = ""
                   record.style.color = ""
               }//stop.onclick
             
             //녹음 시작시킨 상태가 되면 chunks에 녹음 데이터를 저장하라 
             mediaRecorder.ondataavailable = function(e) {
               chunks.push(e.data)
             }  
			//녹음 정지시킨 상태가 되면 실행하라
            mediaRecorder.onstop = function(e) {
              console.log("data available after MediaRecorder.stop() called.")
	
			//추가 구현 예정

            }//mediaRecorder.onstop
               
           })//then 
           .catch(function(err) {
               console.log('The following error occurred: ' + err)
           })
 	}
	</script>
</body>
</html>