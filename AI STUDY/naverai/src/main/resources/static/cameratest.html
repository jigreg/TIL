<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Insert title here</title>
</head>
<body>
<canvas id="camera-output"></canvas>
<video id="camera-view" autoplay playsinline></video>
<button id="camera-btn">사진촬영</button>
<a id="camera-save"></a>
<script>
//dom 객체
var cameraOutput = document.getElementById("camera-output");
var cameraView = document.getElementById("camera-view");
var cameraBtn = document.getElementById("camera-btn");
var cameraSave = document.getElementById("camera-save");

var constraints = {video : {facingMode : "user"} , audio:false }
window.onload = function (){
	//카메라 내용을 video 태그 출력
	navigator.mediaDevices.getUserMedia(constraints)
	.then(function(stream){ cameraView.srcObject = stream; })
	.catch(function(err){ console.log("카메라에 문제가 있습니다.", err); }) 
}// window.onload end

//cameraStart();
/*
function cameraStart(){
	//카메라 내용을 video 태그 출력
	navigator.mediaDevices.getUserMedia(constraints)
	.then(function(stream){ cameraView.srcObject = stream; })
	.catch(function(err){ console.log("카메라에 문제가 있습니다.", err); })
}//cameraStart end
*/

cameraBtn.onclick  = function(){
	cameraOutput.width = cameraView.videoWidth;
	cameraOutput.height = cameraView.videoHeight;
	var cameraContext  = cameraOutput.getContext("2d");
	cameraContext.drawImage(cameraView, 0, 0);
	// 이미지 데이터 = blob 내장객체 ==> url 형태 변환 ===>파일형태 저장 변경( image/png)
 	
	cameraOutput.toBlob(function(blob){  
		var imageURL = URL.createObjectURL(blob);	
		console.log(imageURL);
		cameraSave.href=imageURL;
		cameraSave.innerHTML = "png파일로저장";
		cameraSave.download = "mypic.png"; 
		// a태그 링크 클릭하면 href 내용을 다운로드 파일형태
	} );//toBlob end
	
	
}//on click 
</script>

</body>
</html>